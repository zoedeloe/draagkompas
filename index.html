<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>DRAAGKOMPAS – prototype met filters</title>
<style>
  :root{
    /* Pas kleuren aan je huisstijl aan */
    --brand-bg: #1b179e;   /* jouw paarsblauwe achtergrond */
    --brand-txt: #e6ebff;  /* lichte tekst */
    --accent:   #ff3b30;   /* kompas/rood accent */
    --chip:     #e9efff;
    --ink:      #212428;
    --muted:    #64748b;
    --card:     #ffffff;
    --line:     #e6e6f0;
  }

  html,body{margin:0;padding:0;background:#f7f7fb;color:var(--ink);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;}
  .hero{
    background:var(--brand-bg); color:var(--brand-txt);
    padding:20px 16px; display:flex; gap:16px; align-items:center; flex-wrap:wrap;
  }
  .hero img{ height:56px; width:auto; display:block; }
  .hero h1{ margin:0; font-size:22px; letter-spacing:.5px }
  .wrap{ max-width:1100px; margin:0 auto; padding:16px }

  .filters{
    background:#fff; border:1px solid var(--line); border-radius:12px; padding:12px; margin:12px 0;
    display:grid; gap:10px;
  }
  .filters .row{ display:flex; gap:12px; flex-wrap:wrap; align-items:center }
  .filters label{ font-size:14px; color:var(--muted) }
  .filters .chips{ display:flex; gap:8px; flex-wrap:wrap }
  .chip{ background:var(--chip); border:1px solid var(--line); padding:6px 10px; border-radius:999px; font-size:13px; cursor:pointer; }
  .chip input{ margin-right:6px; }
  select, input[type="search"]{
    border:1px solid var(--line); border-radius:8px; padding:8px 10px; font:inherit; background:#fff;
  }
  .grid{ display:grid; grid-template-columns: repeat(auto-fill,minmax(280px,1fr)); gap:14px; margin:16px 0 }
  .card{
    background:var(--card); border:1px solid var(--line); border-radius:12px; padding:12px;
    box-shadow:0 1px 3px rgba(0,0,0,.05);
  }
  .meta{ color:var(--muted); font-size:13px; margin:4px 0 8px }
  .pills{ display:flex; gap:6px; flex-wrap:wrap; margin:6px 0 }
  .pill{ background:var(--chip); border:1px solid var(--line); padding:2px 8px; border-radius:999px; font-size:12px }
  .tabs{ display:flex; gap:6px; margin-top:8px }
  .tabs button{
    padding:6px 10px; border-radius:8px; border:1px solid var(--line); background:#fafafa; cursor:pointer; font-size:13px
  }
  .tabs button.active{ background:var(--brand-bg); color:#fff; border-color:var(--brand-bg) }
  .section{ display:none; margin-top:8px; font-size:14px }
  .section.active{ display:block }
  .kv{ margin:3px 0 }
  .kv b{ color:var(--ink) }
  .footer{ color:var(--muted); font-size:12px; margin:20px 0 32px }
  .sr{ display:none } /* simple range helper */
</style>
</head>
<body>

<!-- Header met logo -->
<div class="hero">
  <!-- Vervang de src door jouw bestandsnaam als nodig -->
  <img src="DRAAGKOMPAS (1).png" alt="DRAAGKOMPAS logo" />
  <h1>DRAAGKOMPAS – prototype</h1>
</div>

<div class="wrap">

  <!-- Zoek en filters -->
  <div class="filters" id="filters">
    <div class="row" style="gap:10px 20px;">
      <label for="q"><b>Zoek</b></label>
      <input id="q" type="search" placeholder="Zoek op merk, model, type…" style="min-width:260px" />
      <label for="sort"><b>Sorteer</b></label>
      <select id="sort">
        <option value="merk_az">Merk A‑Z</option>
        <option value="maat_min">Maat (start) ↑</option>
        <option value="breedte_min">Min. breedte ↑</option>
        <option value="breedte_max">Max. breedte ↑</option>
        <option value="hoogte_min">Min. hoogte ↑</option>
        <option value="hoogte_max">Max. hoogte ↑</option>
      </select>
    </div>

    <div class="row">
      <label><b>Maat</b></label>
      <div class="chips" id="maatChips">
        <!-- single‑select chips (radio’s) -->
        <label class="chip"><input type="radio" name="maat" value="" checked>Alle</label>
        <label class="chip"><input type="radio" name="maat" value="50">50/56</label>
        <label class="chip"><input type="radio" name="maat" value="62">62</label>
        <label class="chip"><input type="radio" name="maat" value="68">68</label>
        <label class="chip"><input type="radio" name="maat" value="74">74</label>
        <label class="chip"><input type="radio" name="maat" value="80">80</label>
        <label class="chip"><input type="radio" name="maat" value="86">86</label>
        <label class="chip"><input type="radio" name="maat" value="92">92</label>
        <label class="chip"><input type="radio" name="maat" value="98">98</label>
        <label class="chip"><input type="radio" name="maat" value="104">104</label>
      </div>
    </div>

    <div class="row">
      <label><b>Eigenschappen</b></label>
      <div class="chips">
        <label class="chip"><input type="checkbox" id="f_kruisbaar">Kruisbaar</label>
        <label class="chip"><input type="checkbox" id="f_pfa">PFA</label>
        <label class="chip"><input type="checkbox" id="f_water">Waterdrager</label>
        <label class="chip"><input type="checkbox" id="f_harnas">Harnas</label>
        <label class="chip"><input type="checkbox" id="f_ff">Face‑Forward</label>
      </div>
    </div>
  </div>

  <!-- Lijst -->
  <div id="list" class="grid"></div>

  <div class="footer">
    Prototype – filters: maat, kruisbaar, PFA, waterdrager, harnas, face‑forward. Sorteren op merk en maten.
  </div>
</div>

<script>
/** =========================
 * DEMO‑DATA (inkort)
 * Zo kun je nu al testen. Ik neem je VOLLEDIGE DB op in de hosted versie.
 * ========================== */
const DB = {
  "records":[
    {
      "id":"almitra_tattva",
      "always":{"merk":"Almitra Tattva","model":"","type_drager":"Full Buckle (Gespdrager)"},
      "basic":{"speciale_categorie":null,"systeemtype":"full buckle","schouderband_kruisbaar":true,"pfa_aanwezig":true},
      "pro":{"rugpand_breedte_min_cm":18,"rugpand_breedte_max_cm":36,"rugpand_hoogte_min_cm":26,"rugpand_hoogte_max_cm":35},
      "veilig":{"expert_maatadvies":"56-80","face_forward_mogelijk":false}
    },
    {
      "id":"amazonas_carrier",
      "always":{"merk":"Amazonas","model":"Carrier","type_drager":"Full Buckle"},
      "basic":{"speciale_categorie":null,"systeemtype":"full buckle","schouderband_kruisbaar":true,"pfa_aanwezig":false},
      "pro":{"rugpand_breedte_min_cm":29,"rugpand_breedte_max_cm":33,"rugpand_hoogte_min_cm":33,"rugpand_hoogte_max_cm":36},
      "veilig":{"expert_maatadvies":"ruime 56","face_forward_mogelijk":false}
    },
    {
      "id":"aquasling",
      "always":{"merk":"Aquasling","model":"","type_drager":"Ringsling – water"},
      "basic":{"speciale_categorie":"waterdrager","systeemtype":"ringsling","schouderband_kruisbaar":false,"pfa_aanwezig":false},
      "pro":{"rugpand_breedte_min_cm":null,"rugpand_breedte_max_cm":null,"rugpand_hoogte_min_cm":null,"rugpand_hoogte_max_cm":null},
      "veilig":{"expert_maatadvies":"One size","face_forward_mogelijk":false}
    },
    {
      "id":"artipoppe_baby",
      "always":{"merk":"Artipoppe","model":"Zeitgeist Baby","type_drager":"Full Buckle"},
      "basic":{"speciale_categorie":null,"systeemtype":"full buckle","schouderband_kruisbaar":true,"pfa_aanwezig":false},
      "pro":{"rugpand_breedte_min_cm":20,"rugpand_breedte_max_cm":28,"rugpand_hoogte_min_cm":33,"rugpand_hoogte_max_cm":40.5},
      "veilig":{"expert_maatadvies":"62/68 - 86","face_forward_mogelijk":false}
    },
    {
      "id":"babybjorn_harmony",
      "always":{"merk":"BabyBjörn","model":"Harmony","type_drager":"Harnas-stijl"},
      "basic":{"speciale_categorie":null,"systeemtype":"harnas","schouderband_kruisbaar":false,"pfa_aanwezig":false},
      "pro":{"rugpand_breedte_min_cm":18,"rugpand_breedte_max_cm":35,"rugpand_hoogte_min_cm":31,"rugpand_hoogte_max_cm":48},
      "veilig":{"expert_maatadvies":"ruime 56 - 80","face_forward_mogelijk":null}
    }
  ]
};

/** ===== Maat‑parser =====
 * Pakt "56-80", "62/68 - 86", "ruime 56", "86-104", "One size"
 */
function parseMaatRange(txt){
  if(!txt) return null;
  txt = String(txt).toLowerCase();
  if(txt.includes('one size')) return {min:null,max:null, note:'one'};
  // haal alle getallen
  const nums = (txt.match(/\d{2,3}/g)||[]).map(n=>parseInt(n,10));
  if(nums.length===0) return null;
  if(nums.length===1) return {min:nums[0],max:null};
  return {min:nums[0],max:nums[nums.length-1]};
}

function maatMatch(selected, advies){
  if(!selected) return true; // "Alle"
  const want = parseInt(selected,10);
  const r = parseMaatRange(advies);
  if(!r) return false;
  if(r.note==='one') return true; // One size altijd tonen
  if(r.min!=null && r.max!=null) return (want>=r.min && want<=r.max);
  if(r.min!=null && r.max==null) return (want>=r.min);
  return true;
}

/** ====== Rendering ====== */
function el(tag, html, attrs={}){
  const e=document.createElement(tag);
  if(html!==undefined) e.innerHTML=html;
  Object.entries(attrs).forEach(([k,v])=>e.setAttribute(k,v));
  return e;
}

function renderKV(obj){
  if(!obj) return '';
  return Object.entries(obj)
    .filter(([_,v])=>v!==null && v!==undefined && v!=='')
    .map(([k,v])=>`<div class="kv"><b>${k}</b>: ${typeof v==='object'?JSON.stringify(v):v}</div>`)
    .join('');
}

function card(rec){
  const t = (rec.always?.merk||'') + ' ' + (rec.always?.model||'');
  const type = rec.always?.type_drager || '';
  const pills = [];
  if(rec.basic?.speciale_categorie) pills.push(`<span class="pill">${rec.basic.speciale_categorie}</span>`);
  if(rec.basic?.systeemtype)        pills.push(`<span class="pill">${rec.basic.systeemtype}</span>`);
  const id = rec.id;

  const c = el('div','',{'class':'card',id});
  c.appendChild(el('h3', t || id));
  c.appendChild(el('div', type, {'class':'meta'}));
  c.appendChild(el('div', pills.join(' '), {'class':'pills'}));

  const tabs = el('div','',{'class':'tabs'});
  ['always','basic','pro','veilig'].forEach((w,i)=>{
    const b = el('button', w.toUpperCase());
    b.addEventListener('click', ()=>showTab(id,w));
    if(i===0) b.classList.add('active');
    b.classList.add(`tab-${id}-${w}`);
    tabs.appendChild(b);
  });
  c.appendChild(tabs);

  const sAlways = el('div', renderKV(rec.always), {'class':`section sec-${id}-always active`});
  const sBasic  = el('div', renderKV(rec.basic),  {'class':`section sec-${id}-basic`});
  const sPro    = el('div', renderKV(rec.pro),    {'class':`section sec-${id}-pro`});
  const sSafe   = el('div', renderKV(rec.veilig), {'class':`section sec-${id}-veilig`});
  c.append(sAlways, sBasic, sPro, sSafe);
  return c;
}

function showTab(id, which){
  ['always','basic','pro','veilig'].forEach(w=>{
    const sec = document.querySelector(`.sec-${id}-${w}`);
    const tab = document.querySelector(`.tab-${id}-${w}`);
    if(!sec||!tab) return;
    const on = (w===which);
    sec.classList.toggle('active', on);
    tab.classList.toggle('active', on);
  });
}

function comparator(kind){
  switch(kind){
    case 'merk_az':
      return (a,b)=>String(a.always?.merk||'').localeCompare(String(b.always?.merk||''));
    case 'breedte_min':
      return (a,b)=>(a.pro?.rugpand_breedte_min_cm??999)-(b.pro?.rugpand_breedte_min_cm??999);
    case 'breedte_max':
      return (a,b)=>(a.pro?.rugpand_breedte_max_cm??999)-(b.pro?.rugpand_breedte_max_cm??999);
    case 'hoogte_min':
      return (a,b)=>(a.pro?.rugpand_hoogte_min_cm??999)-(b.pro?.rugpand_hoogte_min_cm??999);
    case 'hoogte_max':
      return (a,b)=>(a.pro?.rugpand_hoogte_max_cm??999)-(b.pro?.rugpand_hoogte_max_cm??999);
    case 'maat_min':
      return (a,b)=>{
        const pa=parseMaatRange(a.veilig?.expert_maatadvies), pb=parseMaatRange(b.veilig?.expert_maatadvies);
        const va = pa?.min ?? 999, vb = pb?.min ?? 999;
        return va - vb;
      };
    default:
      return ()=>0;
  }
}

function passesToggles(rec, tgl){
  if(tgl.kruisbaar && !rec.basic?.schouderband_kruisbaar) return false;
  if(tgl.pfa && !rec.basic?.pfa_aanwezig) return false;
  if(tgl.water && (rec.basic?.speciale_categorie!=='waterdrager')) return false;
  if(tgl.harnas && (rec.basic?.systeemtype!=='harnas')) return false;
  if(tgl.ff){
    const ff = rec.veilig?.face_forward_mogelijk;
    if(ff!==true) return false;
  }
  return true;
}

function renderList(){
  const q = document.getElementById('q').value.trim().toLowerCase();
  const sort = document.getElementById('sort').value;
  const maatSel = (document.querySelector('input[name="maat"]:checked')||{}).value || '';
  const tgl = {
    kruisbaar: document.getElementById('f_kruisbaar').checked,
    pfa:       document.getElementById('f_pfa').checked,
    water:     document.getElementById('f_water').checked,
    harnas:    document.getElementById('f_harnas').checked,
    ff:        document.getElementById('f_ff').checked
  };

  let items = DB.records.slice();

  // text search
  if(q){
    items = items.filter(r=>{
      const hay = JSON.stringify(r).toLowerCase();
      return hay.includes(q);
    });
  }
  // maat filter
  items = items.filter(r=> maatMatch(maatSel, r.veilig?.expert_maatadvies));
  // toggles
  items = items.filter(r=> passesToggles(r, tgl));
  // sort
  items.sort(comparator(sort));

  const list = document.getElementById('list');
  list.innerHTML = '';
  if(items.length===0){
    list.innerHTML = `<div style="grid-column:1/-1; color:#8c8fa1">Geen resultaten voor je combinatie. Pas je filters aan.</div>`;
    return;
  }
  items.forEach(r=> list.appendChild(card(r)));
}

document.addEventListener('DOMContentLoaded', ()=>{
  ['q','sort','f_kruisbaar','f_pfa','f_water','f_harnas','f_ff'].forEach(id=>{
    const el = document.getElementById(id);
    if(el) el.addEventListener('input', renderList);
  });
  document.querySelectorAll('input[name="maat"]').forEach(r=>r.addEventListener('change', renderList));
  renderList();
});
</script>

</body>
</html>
